!function t(e,i,n){function r(o,a){if(!i[o]){if(!e[o]){var c="function"==typeof require&&require;if(!a&&c)return c(o,!0);if(s)return s(o,!0);var h=new Error("Cannot find module '"+o+"'");throw h.code="MODULE_NOT_FOUND",h}var u=i[o]={exports:{}};e[o][0].call(u.exports,function(t){var i=e[o][1][t];return r(i?i:t)},u,u.exports,t,e,i,n)}return i[o].exports}for(var s="function"==typeof require&&require,o=0;o<n.length;o++)r(n[o]);return r}({1:[function(t,e,i){(function(n,r){var s=t("./model"),o=t("./collection");i.Model=s.createClass(),i.Collection=o.createClass(),i.createModelClass=s.createClass,i.createCollectionClass=o.createClass,i.setVirtuals=t("./set-virtuals"),i.load=t("./load"),i.singleton=t("./singleton"),i.save=t("./save"),i.watchProperty=t("./watch-property"),i.bindProperty=t("./bind-property"),i.watchModelsMixin=t("./watch-models-mixin"),i.getAsync=t("./get-async"),i.recycle=t("./recycle"),i.reference=t("./reference"),n.browser&&(r.Caplet=e.exports)}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./bind-property":3,"./collection":4,"./get-async":6,"./load":7,"./model":9,"./recycle":10,"./reference":11,"./save":12,"./set-virtuals":13,"./singleton":14,"./watch-models-mixin":15,"./watch-property":16,_process:17}],2:[function(t,e){function i(t,e){return function(){return n(t.apply(this,arguments)||{},e.apply(this,arguments)||{})}}var n=t("xtend/mutable");e.exports=function(t){for(var e={},n=0,r=t.length;r>n;n++)for(var s=t[n],o=Object.keys(s),a=0,c=o.length;c>a;a++){var h=o[a],u=s[h],l=typeof u;"function"===l&&e[h]&&(u=i(e[h],u)),e[h]=u}return e}},{"xtend/mutable":24}],3:[function(t,e){var i=t("./watch-property");e.exports=function(t,e,n,r){r||(r=e),"string"==typeof n&&(r=n,n=t);var s=i(t,e,function(t){n.set(r,t)});return s}},{"./watch-property":16}],4:[function(t,e){function i(t){var e={};t||(t={}),"[object Array]"===Object.prototype.toString.call(t)?e.source=t:e=t,this.getInitialProperties&&(e=o({},this.getInitialProperties(),e)),n.call(this),this.setProperties(e),this.createModel=this.createModel.bind(this);var i=this;r(this,"data",this.onDataChange,!0).trigger(),this.initialize(),this.onChange&&this.watch(function(){i.onChange()})}var n=t("watchable-collection"),r=t("./watch-property"),s=t("./model").createClass(),o=t("xtend/mutable"),a=t("./missing-property-mixin"),c=t("./_mixin");n.extend(i,{__isCollection:!0,modelClass:s,initialize:function(){},createModel:function(t){var e=new this.modelClass(t);return this.onCreateModel(e),e},fromData:function(t){return{source:this.castModels(t)}},toData:function(){return this.source.map(function(t){return t.toData()})},toJSON:function(){return this.toData()},onDataChange:function(t){var e=this.fromData(t);e.source=this.mergeSource(e.source),this.setProperties(e)},onCreateModel:function(){},get:a.get,mergeSource:function(t){for(var e=t.concat(),i=this.source,n=t.length;n--;)for(var r=t[n],s=i.length;s--;){var o=i[s];if(r.equals(o)){o.set("data",r.toData()),e.splice(n,1,o);break}}return e},castModels:function(t){var e=this;return(t||[]).map(function(t){return e.createModel({data:t})})},_watchModels:function(){n.prototype._watchModels.call(this),this._unwatchModels(),this._modelListeners=[];var t=this;this.source.forEach(function(e){t._modelListeners.push(e.once("dispose",function(){t.splice(t.indexOf(e),1)}))})},_unwatchModels:function(){if(this._modelListeners){for(var t=this._modelListeners.length;t--;)this._modelListeners[t].dispose();this._modelListeners=void 0}},dispose:function(){n.prototype.dispose.call(this),this.emit("dispose")}});var h=i.extend;i.extend=function(t){function e(t){return this instanceof n?void n.call(this,t):new e(t)}var n=this;return t&&t.mixins&&(t=c([t].concat(t.mixins))),h.call(n,e,t),e.extend=i.extend,e},i.createClass=i.extend.bind(i),e.exports=i},{"./_mixin":2,"./missing-property-mixin":8,"./model":9,"./watch-property":16,"watchable-collection":20,"xtend/mutable":24}],5:[function(t,e){(function(t){e.exports=function(e,i){if(!t.browser)return e;var n;return function(){clearTimeout(n),n=setTimeout(e,i)}}}).call(this,t("_process"))},{_process:17}],6:[function(t,e){var i=t("./watch-property");e.exports=function(t,e,n){var r=i(t,e,function(t){r.dispose(),n(void 0,t)});r.trigger()}},{"./watch-property":16}],7:[function(t,e){var i=t("./singleton");e.exports=function(t,e,n){i(t,"load",e,function(e,i){return e?n(e):(t.set("data",i),void n(null,t))})}},{"./singleton":14}],8:[function(t,e){var i=t("watchable-object");e.exports={get:function(t){var e=i.prototype.get.call(this,t);if(void 0!=e)return e;var n=("string"==typeof t?t.split("."):t)[0];return this._missingProperties||(this._missingProperties={}),this._missingProperties[n]?void 0:(this.emit("missingProperty",this._missingProperties[n]=n),void 0!=this[n]?this.get(t):void 0)}}},{"watchable-object":22}],9:[function(t,e){function i(t){return"[object Object]"===Object.prototype.toString.call(t)}function n(t){t=i(t)?t:{data:t},this.getInitialProperties&&(t=o({},this.getInitialProperties(),t)),r.call(this,t);var e=this;s(this,"data",this.onDataChange,!0).trigger(),this.initialize(),this.onChange&&this.watch(function(){e.onChange()})}var r=t("watchable-object"),s=t("./watch-property"),o=t("xtend/mutable"),a=t("./missing-property-mixin"),c=t("./_mixin");r.extend(n,{data:void 0,initialize:function(){},fromData:function(t){return i(t)?t:{}},toData:function(){var t={};if(this.data&&!i(this.data))return this.data;for(var e=Object.keys(this.data?this.data:this),n=0,r=e.length;r>n;n++){var s=e[n];s in this.constructor.prototype||95===s.charCodeAt(0)||(t[s]=this[s])}return t},equals:function(t){return this.uid&&this.uid===t.uid||this.data===t.data},toJSON:function(){return this.toData()},onDataChange:function(t){this.setProperties(this.fromData(t))},get:a.get,dispose:function(){r.prototype.dispose.call(this),this.emit("dispose")}});var h=n.extend;n.extend=function(t){function e(t){return this instanceof i?void i.call(this,t):new e(t)}var i=this;return t&&t.mixins&&(t=c([t].concat(t.mixins))),h.call(i,e,t),e.extend=n.extend,e},n.createClass=n.extend.bind(n),e.exports=n},{"./_mixin":2,"./missing-property-mixin":8,"./watch-property":16,"watchable-object":22,"xtend/mutable":24}],10:[function(t,e){e.exports=function(t,e,i){return t instanceof e?t.setProperties(i):t=new e(i),t}},{}],11:[function(t,e){var i=t("./model"),n=t("./watch-property");e.exports=function(t,e){var r=new i({value:t.get(e)});return n(t,e,r.set.bind(r,"value")),n(r,"value",t.set.bind(t,"value")),r}},{"./model":9,"./watch-property":16}],12:[function(t,e){e.exports=function(t,e,i,n){return n||(n=function(){}),t.uid?i.call(t,n):e.call(t,n)}},{}],13:[function(t,e){(function(i){var n=t("xtend/mutable");e.exports=function(t,e){function r(e){return t.__virtuals[e]?t.__virtuals[e]:t.__virtuals["*"]?function(i){t.__virtuals["*"].call(this,e,i)}:void 0}return t.__virtuals?n(t.__virtuals,e):(t.__virtuals=e,void t.on("missingProperty",function(e){function n(n,r){return n?t.emit("error",n):void(i.browser?i.nextTick(function(){t.set(e,r)}):t.set(e,r))}var s=r(e);if(s){var o=s.call(t,n);void 0!=o&&n(void 0,o)}}))}}).call(this,t("_process"))},{_process:17,"xtend/mutable":24}],14:[function(t,e){e.exports=function(t,e,i,n){t._singletons||(t._singletons={});var r="singleton:"+e;t.once(r,n||function(){});var s=t._singletons[e];return void 0!=s?s:(t._singletons[e]=s={dispose:function(){t._singletons[e]=void 0}},i.call(t,function(e,i){t.emit.apply(t,[r,e,i])}),s)}},{}],15:[function(t,e){function i(t,e){for(var i in t)if(t[i]!==e[i])return!0;return!1}var n=t("./debounce");e.exports={componentDidMount:function(){this._watch()},componentWillUpdate:function(){this._watch()},shouldComponentUpdate:function(t,e){return i(this.props,t)||i(t,this.props)||i(this.state,e)||i(e,this.state)},componentWillUnmount:function(){this._unwatch()},_watch:function(){this._unwatch(),this._watchers=[],this._watchDict(this.props),this._watchDict(this.state)},_watchDict:function(t){var e=n(this.forceUpdate.bind(this,null),10);for(var i in t){var r=t[i];r&&r.__isWatchableObject&&this._watchers.push(t[i].watch(e))}},_unwatch:function(){if(this._watchers)for(var t=this._watchers.length;t--;)this._watchers[t].dispose();this._watchers=void 0}}},{"./debounce":5}],16:[function(t,e){function i(t,e,i,n){this.target=t,this.listener=i,this.property=e,this.immediate=!!n,this.oldValue=void 0;var r=this;this._disposable=this._watch(this.target,function(){r.trigger()})}i.prototype.trigger=function(t){var e=this.target.get(this.property);if(t!==!0&&this.oldValue===e)return this;if(this._valueWatcher&&this._valueWatcher.dispose(),e&&e.__isWatchableObject){var i=this;this._valueWatcher=this._watch(e,function(){i.trigger(!0)})}return this.oldValue=e,this.listener.call(this.target,e,this.oldValue),this},i.prototype._watch=function(t,e){return this.immediate?t.on("willChange",e):t.watch(e)},i.prototype.dispose=function(){return this._valueWatcher&&this._valueWatcher.dispose(),this._disposable.dispose(),this},e.exports=function(t,e,n,r){return new i(t,e,n,r)}},{}],17:[function(t,e){function i(){if(!o){o=!0;for(var t,e=s.length;e;){t=s,s=[];for(var i=-1;++i<e;)t[i]();e=s.length}o=!1}}function n(){}var r=e.exports={},s=[],o=!1;r.nextTick=function(t){s.push(t),o||setTimeout(i,0)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=n,r.addListener=n,r.once=n,r.off=n,r.removeListener=n,r.removeAllListeners=n,r.emit=n,r.binding=function(){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},{}],18:[function(t,e){"use strict";function i(){this.__events={}}t("protoclass");i.prototype.on=function(t,e){if("function"!=typeof e)throw new Error("listener must be a function for event '"+t+"'");var i;(i=this.__events[t])?"function"==typeof i?this.__events[t]=[i,e]:i.push(e):this.__events[t]=e;var n=this;return{dispose:function(){n.off(t,e)}}},i.prototype.off=function(t,e){var i;if(i=this.__events[t])if("function"==typeof i)this.__events[t]=void 0;else{var n=i.indexOf(e);~n&&i.splice(n,1),i.length||(this.__events[t]=void 0)}},i.prototype.once=function(t,e){function i(){n.dispose(),e.apply(this,arguments)}if("function"!=typeof e)throw new Error("listener must be a function for event '"+t+"'");var n=this.on(t,i);return n.target=this,n},i.prototype.emit=function(t){if(void 0!==this.__events[t]){var e,i,n,r=this.__events[t],s=arguments.length;if("function"==typeof r)if(1===s)r();else switch(s){case 2:r(arguments[1]);break;case 3:r(arguments[1],arguments[2]);break;case 4:r(arguments[1],arguments[2],arguments[3]);break;default:for(e=new Array(s-1),i=1;s>i;i++)e[i-1]=arguments[i];r.apply(this,e)}else{for(e=new Array(s-1),i=1;s>i;i++)e[i-1]=arguments[i];for(n=r.length;n--;)r[n]&&r[n].apply(this,e)}}},i.prototype.removeAllListeners=function(t){1===arguments.length?this.__events[t]=void 0:this.__events={}},e.exports=i},{protoclass:19}],19:[function(t,e){function i(t,e){for(var i=0,n=e.length;n>i;i++){var r=e[i];for(var s in r)t[s]=r[s]}return t}function n(t,e){function r(){this.constructor=e}var s=Array.prototype.slice.call(arguments,2);return"function"!=typeof e&&(e&&s.unshift(e),e=t,t=function(){}),i(e,t),r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e.parent=e.superclass=t,i(e.prototype,s),n.setup(e),e}n.setup=function(t){return t.extend||(t.extend=function(t){var e=Array.prototype.slice.call(arguments,0);return"function"!=typeof t&&e.unshift(t=function(){t.parent.apply(this,arguments)}),n.apply(this,[this].concat(e))},t.mixin=function(){i(this.prototype,arguments)},t.create=function(){var e=Object.create(t.prototype);return t.apply(e,arguments),e}),t},e.exports=n},{}],20:[function(t,e){function i(t){n.call(this),this.source=t||[],this.length=this.source.length;var e=this;r(this,"source",function(){e._onChange()}).trigger()}{var n=t("watchable-object"),r=t("./watchProperty");t("watchable-object/lib/runloop").instance}n.extend(i,{at:function(t){return t<this.length?this.source[t]:void 0},map:function(t){return this.source.map(t)},filter:function(t){return this.source.filter(t)},forEach:function(t){return this.source.forEach(t)},join:function(t){return this.source.join(t)},pop:function(){return this.splice(this.source.length-1,1).pop()},shift:function(){return this.splice(0,1).pop()},push:function(){this.source.push.apply(this.source,arguments),this._onChange()},unshift:function(){this.source.unshift.apply(this.source,arguments),this._onChange()},indexOf:function(t){return this.source.indexOf(t)},splice:function(){var t=(Array.prototype.splice.apply(2,arguments),this.source.splice.apply(this.source,arguments));return this._onChange(),t},_onChange:function(){this.set("length",this.source.length)||this._triggerChange(this),this._watchModels()},_watchModels:function(){if(this._modelWatchers)for(var t=this._modelWatchers.length;t--;)this._modelWatchers[t].dispose();var e=function(){this._triggerChange(this)}.bind(this);this._modelWatchers=[];for(var t=this.source.length;t--;){var i=this.at(0);i&&i.__isWatchableObject&&this._modelWatchers.push(i.on("willChange",e))}}}),e.exports=i},{"./watchProperty":21,"watchable-object":22,"watchable-object/lib/runloop":23}],21:[function(t,e){e.exports=function(t,e,i){var n,r,s={trigger:function(){var r=t.get(e);n!==r&&(n=r,i(r,n))},dispose:function(){r.dispose()}};return r=t.on("willChange",s.trigger),s}},{}],22:[function(t,e){function i(t){if(r.call(this),this.__watchable={},this.__onChange=this.__onChange.bind(this),t)for(var e in t)this._watchProperty(e,this[e]=t[e])}var n=t("protoclass"),r=t("fast-event-emitter"),s=t("./runloop").instance;n(r,i,{__isWatchableObject:!0,_changeId:0,watch:function(t){function e(){r.disposed||(i=n.on("change",t))}var i,n=this,r={disposed:!1,dispose:function(){r.disposed=!0,i&&i.dispose()}};return s.defer(e),r},get:function(t){var e;if((e="string"==typeof t)&&!~t.indexOf("."))return this[t];for(var i=e?t.split("."):t,n=this,r=0,s=i.length-1;s>r;r++){if(n=n[i[r]],!n)return;if(n.get)return n.get(i.slice(r+1))}return n[i[r]]},set:function(t,e,i){var n;n="string"==typeof t?t.split("."):t;for(var r,s=this,o=this.get(n)!==e,a=0,c=n.length-1;c>a;a++){if(r=s[n[a]],r&&r.set)return r.set(n.slice(a+1),e);r||(r=s[n[a]]={}),s=r}return s[n[a]]=e,this._watchProperty(t,e),i!==!1&&o&&this._triggerChange(this),o},_watchProperty:function(t,e){if(e!==this)if(e&&e.__isWatchableObject){var i=this;this.__watchable[t]=e.on("willChange",function(e){return i.get(t)?void(e!==i&&i._triggerChange(e)):i._watchProperty(t,void 0)})}else{this.__watchable[t]&&this.__watchable[t].dispose(),this.__watchable[t]=void 0;var n=Object.prototype.toString.call(e);if("[object Object]"===n)for(var r in e)this._watchProperty(t+"."+r,e[r])}},setProperties:function(t){var e=!1;for(var i in t)e=this.set(i,t[i],!1)||e;return e&&this._triggerChange(this),e},_triggerChange:function(t){this._changeDefer&&t!==this||this.emit("willChange",t),this._changeDefer&&this._changeDefer.reDefer()||(this._changeDefer=s.defer(this.__onChange))},__onChange:function(){this._changeDefer=void 0,this.emit("change",this)},dispose:function(){for(var t in this.__watchable)this.__watchable[t]&&this.__watchable[t].dispose();this.__watchable={},this._listeners=void 0,this.removeAllListeners("change"),this.removeAllListeners("willChange")}}),e.exports=i},{"./runloop":23,"fast-event-emitter":18,protoclass:19}],23:[function(t,e){(function(i,n){function r(t){o.call(this),this._animationQueue=[],this.tick=t.tick||c,this._id=t._id||2}var s=t("protoclass"),o=t("fast-event-emitter"),a=(n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||i.nextTick).bind(n),c=function(t){a(t)};s(o,r,{child:function(){return this.__child||(this.__child=new r({tick:this.tick,_id:this._id<<2}))},defer:function(t){this._running,this._animationQueue.push(t);var e=this,i={dispose:function(){var i=e._animationQueue.indexOf(t);~i&&e._animationQueue.splice(i,1)},reDefer:function(){var i=e._animationQueue.indexOf(t);return~i?(e._animationQueue.splice(i,1),e._animationQueue.push(t),!0):!1}};if(this._requestingFrame)return i;this._requestingFrame=!0;var e=this;return this.tick(function(){e.runNow(),e._requestingFrame=!1}),i},runNow:function(){var t=this._animationQueue;this._animationQueue=[],this._running=!0;for(var e=0;e<t.length;e++){var i=t[e];i(),this._animationQueue.length&&this.runNow()}this.emit("drained"),this._running=!1}}),r.instance=new r({}),e.exports=r}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:17,"fast-event-emitter":18,protoclass:19}],24:[function(t,e){function i(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])}return t}e.exports=i},{}]},{},[1]);